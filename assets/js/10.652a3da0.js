(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{366:function(t,e,s){"use strict";s.r(e);var a=s(42),r=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"system-overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#system-overview"}},[t._v("#")]),t._v(" System Overview")]),t._v(" "),s("h2",{attrs:{id:"system-context-diagram"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#system-context-diagram"}},[t._v("#")]),t._v(" System Context Diagram")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/system-plgd.svg",alt:"L1"}})]),t._v(" "),s("h2",{attrs:{id:"plgd-context-diagram"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plgd-context-diagram"}},[t._v("#")]),t._v(" plgd Context Diagram")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/container-plgd.svg",alt:"L2"}})]),t._v(" "),s("h2",{attrs:{id:"coap-gateway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#coap-gateway"}},[t._v("#")]),t._v(" CoAP Gateway")]),t._v(" "),s("p",[t._v("The CoAP gateway acts act as a CoAP Client, communicating with IoT Devices - CoAP Servers following OCF specification. As the component diagram describes, responsibilities of the gateway are:")]),t._v(" "),s("ul",[s("li",[t._v("handle and maintain TCP connections comming from devices")]),t._v(" "),s("li",[t._v("forward "),s("a",{attrs:{href:"https://openconnectivity.org/specs/OCF_Device_To_Cloud_Services_Specification_v2.2.0.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("authentication and authorization requests #5.4.4"),s("OutboundLink")],1),t._v(" #5.4.4 to Authorization Service")]),t._v(" "),s("li",[t._v("process device CRUDN operations which are by its nature forwarded to "),s("a",{attrs:{href:"resource-aggregate"}},[t._v("Resource Aggregate")]),t._v(" or "),s("a",{attrs:{href:"resource-directory"}},[t._v("Resource Directory")])])]),t._v(" "),s("h3",{attrs:{id:"operational-flow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#operational-flow"}},[t._v("#")]),t._v(" Operational flow")]),t._v(" "),s("p",[t._v("Device after it connects to the CoAP Gateway over TCP needs to send an authorization request. If it is the first connection, device needs to register. As the plgd.cloud uses standardized OAuth2.0 flow, device needs to firstly receive a unique "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc6749#section-4.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("authorization code"),s("OutboundLink")],1),t._v(" from the Client(#component-client) and proceed with registration called Sign Up request. Goal of the Sign Up request is to exchange the authorization code for an access and refresh token, which is after successful validation by the OAuth2.0 Server returned back to the device.")]),t._v(" "),s("img",{attrs:{src:"https://www.plantuml.com/plantuml/svg/ZP4zJyCm48Pt_ufJM425Y39sGBLIo5YKyB6m6EVYM2rsT7RwmQ_7TfCX4WFUVFVUyvvVhvqNv8VlFUjqWz1Qwx_iYR4-LBNKlJ0UDaiG3h8D7hH4k5fcisvHVgHsOVaBbCBZKPpd2bud0HzyPqd_2A-jWHhfW3GNLZm9AtHse635bI9K0Pan5fQuUqncYyKAQgqClFLCaHrws4RqGtuFSul2XXUL5CdFUtja44u414vOAMAUJh8JHY68sQ2qAGe28IKw1zxkqAJnC9UcL_2EfDlp7uv9H-W7Ch3TVPfhVe6yHiWjLDWIkcwwvdb-mz0qR5miH10Ngr1fvv6WkOHEOoHi14zzRAPAJ0GR6Ff_ER9ry0o__Wi0",alt:"Sequence"}}),t._v(" "),s("p",[t._v("Successful registration to the plgd.dev is followed by authentication request called Sign In. Device needs to Sign In right after it sucessfully established the connection to the CoAP Gateway, otherwise it won't be marked as online - it won't be available. Sign In requests authorizes the opened TCP connection by verifying the Access Token.")]),t._v(" "),s("img",{attrs:{src:"https://www.plantuml.com/plantuml/svg/LO_D2i8m383lUOemZyE3rnraPOFXJQRekRQn5cixsiwVjxVhHDWf9Fdo9Qb3v3wE3mCtBGclpiMBUmCCgQg57hYDs6wG1onQUcf1kDeKYsxJdNExSMoF7O_qufybqRCCz1JSw9E1AUL99R80IExrDZlAiiA3LXPt5gPyBbTuuaRB12CJ8b30exlJdqZgQQubORWdbFE9QPkpHbi2Jt7qzXUodkIq06goCdtz1G00",alt:"Sequence"}}),t._v(" "),s("p",[t._v("As device capabilities is represented by set of resources, device needs to inform the plgd.cloud which resources are available remotely by publishing them. Information which is published is not the resource representation itself, but "),s("a",{attrs:{href:"https://openconnectivity.org/specs/OCF_Device_To_Cloud_Services_Specification_v2.2.0.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("Resource Information #6.1.3.2.2"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"di"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"e61c3e6b-9c54-4b81-8ce5-f9039c1d04d9"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"links"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"anchor"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ocf://e61c3e6b-9c54-4b81-8ce5-f9039c1d04d9"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"href"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/myLightSwitch"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rt"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oic.r.switch.binary"')]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"if"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oic.if.a"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"oic.if.baseline"')]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"p"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"bm"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eps"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n               "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ep"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"coaps://[fe80::b1d6]:1111"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n               "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pri"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n               "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ep"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"coaps://[fe80::b1d6]:1122"')]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n               "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ep"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"coaps+tcp://[2001:db8:a::123]:2222"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n               "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pri"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ttl"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600476")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Published resource information doesn't contains only link to the resource to be able to CRUDN particular capability, but also resource types which are used to filter only resources client is able to use. As an example, if you have an application which controls the light, this app will search for all lights you have at home - filter resources type "),s("code",[t._v("oic.r.switch.binary")]),t._v(", and not for temperature sensors, even if it was published by the same device. This resource publish command registers the resource aggregate in the plgd.cloud what makes it discoverable to all authorized clients.")]),t._v(" "),s("p",[t._v("The plgd.cloud is after successful resource publish starting observation of each resource. The CoAP Gateway is registered as a client interested in representation changes of each resource, what builds eventually consistend resource shadow inside of the plgd.cloud. Response to the resource observation request contains "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7641#section-1.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("current representation"),s("OutboundLink")],1),t._v(". Additional responses called "),s("a",{attrs:{href:"https://tools.ietf.org/html/rfc7641#section-3.2",target:"_blank",rel:"noopener noreferrer"}},[t._v("notifications"),s("OutboundLink")],1),t._v(" are send whenever the state of the resource changes.")]),t._v(" "),s("img",{attrs:{src:"https://www.plantuml.com/plantuml/svg/RP0z2uCm443t_8h3ZjAXQuUYA3XMXD8vcgi6R1BoOTj_tzEge7JDU_SkNE8yjpuyUzP9WV3GsjVwpPYXLzb8mvM7_0JSGPJZ81k4modQqAouJpZJQGa5z_ZYdwrHfPDGeTF1KY5jMuijcH5Zr3vUfaOSdw4CTIzT1ulgs4X8eCH_Rj47gnQDQgDshHtQ0S7yT1HWvu7PNmC4335KddkfrMxTpGZwvJgyb-VTB44bw89V",alt:"Sequence"}}),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-coapgateway.svg",alt:"L3"}})]),t._v(" "),s("h2",{attrs:{id:"grpc-gateway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#grpc-gateway"}},[t._v("#")]),t._v(" gRPC Gateway")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-grpcgateway.svg",alt:"L3"}})]),t._v(" "),s("h2",{attrs:{id:"http-gateway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-gateway"}},[t._v("#")]),t._v(" HTTP Gateway")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-httpgateway.svg",alt:"L3"}})]),t._v(" "),s("h2",{attrs:{id:"resource-aggregate"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resource-aggregate"}},[t._v("#")]),t._v(" Resource Aggregate")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-resourceaggregate.svg",alt:"L3"}})]),t._v(" "),s("h2",{attrs:{id:"resource-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resource-directory"}},[t._v("#")]),t._v(" Resource Directory")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-resourcedirectory.svg",alt:"L3"}})]),t._v(" "),s("h2",{attrs:{id:"device"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#device"}},[t._v("#")]),t._v(" Device")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-device.svg",alt:"L3"}})]),t._v(" "),s("h2",{attrs:{id:"client"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#client"}},[t._v("#")]),t._v(" Client")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/diagrams/component-clients.svg",alt:"L3"}})])])}),[],!1,null,null,null);e.default=r.exports}}]);